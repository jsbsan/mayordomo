' Gambas class file

Private listaEstrategia As New InterfaceCrearComando[]

Public Sub _new()
    ''En el constructor indico que estrategia de construcci칩n de comandos estan diponibles...
    ''------------------------------------------
    ''NOTE: Listado de Estrategias disponibles:
    ''------------------------------------------
    ''NOTE: Si hubieran mas estrategias se a침adirian continuacion
    '--- poner aqui nuevas estrategias... Dim XXXXXtmp as new EstrategiaXXXXX

    '.---- a침adir la estrategias a la lista de estrategias disponibles  estrategiaXXXXtmp.nombre=("XXXX")

    'a침ado las distitas estrategias...add(XXXXXtmp)
    '...

End

Public Function listaComando() As String[]
    'Este comando devuelve automaticamente la lista de comandos que hay disponibles, por ejemplo es usado para rellenar el combobox del formulario

    Dim est As InterfaceCrearComando
    Dim ComandosReconocidos As New String[]

    For Each est In listaEstrategia
        ComandosReconocidos.Add(est.nombre)
    Next
    Return ComandosReconocidos

End

Public Sub operar(orden As String, datos As String) As Comando

    Dim iCrearcomando As New InterfaceCrearComando
    Dim ordensimilar As String

    ordensimilar = "Orden" & Upper$(Mid$(orden, 1, 1)) & Right(orden, Len(orden) - 1)

    Try iCrearcomando = object.new(ordensimilar) 'creo un objeto de la clase

    If Error Then
        Message.Info(("Error: Comando desconocido") & " (" & orden & ")")
        Return Null
    Else
        Return iCrearcomando.crearComando(datos)
    Endif

    ' For Each iCrearcomando In listaEstrategia
    '
    '     If iCrearcomando.guard(orden) Then
    '         Return iCrearcomando.crearComando(datos)
    '     Endif
    '
    ' Next
    ' 'si llega aqui es que no ha encontrado el comando
    ' Message.Info(("Error: Comando desconocido") & " (" & orden & ")")
    ' Return Null

End

Public Sub add(estrategia As InterfaceCrearComando)

    listaEstrategia.Add(estrategia)

End

Public Function ayuda(orden As String) As String

    Dim iCrearcomando As New InterfaceCrearComando

    For Each iCrearcomando In listaEstrategia

        If iCrearcomando.guard(orden) Then
            Return iCrearcomando.ayuda()
        Endif

    Next
    'si llega aqui es que no ha encontrado el comando

    Return "Error: Comando desconocido" & " (" & orden & ")"

End

Public Function tutorial() As String

    Dim iCrearcomando As New InterfaceCrearComando
    Dim tutorial As String

    For Each iCrearcomando In listaEstrategia

        tutorial &= "**********************\n" & iCrearcomando.nombre & "\n" & "**********************\n" & iCrearcomando.ayuda() & "\n" & "\n"

    Next

    Return tutorial

End
